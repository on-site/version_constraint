<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
    <title>Tests for version_constraint.js</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="../src/version_constraint.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/qunit/qunit-git.css" type="text/css" media="screen" />
    <script type="text/javascript" src="http://code.jquery.com/qunit/qunit-git.js"></script>

    <script>
      $(function() {
        $("#qunit-header").html($("title").html());

        function assertParseVersion(version, expected) {
          deepEqual($.parseVersion(version), expected, "$.parseVersion('" + version + "')");
        }

        function assertCompareVersion(a, b, expected) {
          equal($.compareVersion(a, b), expected, "$.compareVersion('" + a + "', '" + b + "')");
        }

        function assertVersion(a, b, expected) {
          equal($.version(a, b), expected, "$.version('" + a + "', '" + b + "')");
        }

        module("parseVersion");

        test("works for ''", function() {
          assertParseVersion("", []);
        });

        test("works for '1'", function() {
          assertParseVersion("1", [1]);
        });

        test("works for '1.2'", function() {
          assertParseVersion("1.2", [1, 2]);
        });

        test("works for '1.2.3'", function() {
          assertParseVersion("1.2.3", [1, 2, 3]);
        });

        module("compareVersion");

        test("same version", function() {
          assertCompareVersion("", "", 0)
          assertCompareVersion("1", "1", 0)
          assertCompareVersion("1.2", "1.2", 0)
          assertCompareVersion("1.2.3", "1.2.3", 0)
        });

        test("smaller version", function() {
          assertCompareVersion("", "1", -1);
          assertCompareVersion("0", "1", -1);
          assertCompareVersion("", "1.2", -1);
          assertCompareVersion("1", "1.2", -1);
          assertCompareVersion("1.1", "1.2", -1);
          assertCompareVersion("0.2", "1.2", -1);
          assertCompareVersion("0.3", "1.2", -1);
          assertCompareVersion("", "1.2.3", -1);
          assertCompareVersion("1", "1.2.3", -1);
          assertCompareVersion("1.2", "1.2.3", -1);
          assertCompareVersion("1.2.2", "1.2.3", -1);
          assertCompareVersion("1.1.3", "1.2.3", -1);
          assertCompareVersion("1.1.4", "1.2.3", -1);
          assertCompareVersion("0.2.3", "1.2.3", -1);
          assertCompareVersion("0.3.3", "1.2.3", -1);
          assertCompareVersion("0.2.4", "1.2.3", -1);
        });

        test("bigger version", function() {
          assertCompareVersion("1", "", 1);
          assertCompareVersion("1", "0", 1);
          assertCompareVersion("1.2", "", 1);
          assertCompareVersion("1.2", "1", 1);
          assertCompareVersion("1.2", "1.1", 1);
          assertCompareVersion("1.2", "0.2", 1);
          assertCompareVersion("1.2", "0.3", 1);
          assertCompareVersion("1.2.3", "", 1);
          assertCompareVersion("1.2.3", "1", 1);
          assertCompareVersion("1.2.3", "1.2", 1);
          assertCompareVersion("1.2.3", "1.2.2", 1);
          assertCompareVersion("1.2.3", "1.1.3", 1);
          assertCompareVersion("1.2.3", "1.1.4", 1);
          assertCompareVersion("1.2.3", "0.2.3", 1);
          assertCompareVersion("1.2.3", "0.3.3", 1);
          assertCompareVersion("1.2.3", "0.2.4", 1);
        });

        module("'1.2.3' style");

        test("equals the exact version", function() {
          assertVersion("1.2.3", "1.2.3", true);
        });

        test("wrong major version", function() {
          assertVersion("1.2.3", "2.2.3", false);
          assertVersion("1.2.3", "0.2.3", false);
        });

        test("wrong minor version", function() {
          assertVersion("1.2.3", "1.3.3", false);
          assertVersion("1.2.3", "1.1.3", false);
        });

        test("wrong build version", function() {
          assertVersion("1.2.3", "1.2.4", false);
          assertVersion("1.2.3", "1.2.2", false);
        });

        test("missing build version", function() {
          assertVersion("1.2.3", "1.2", false);
          assertVersion("1.2.3", "1", false);
        });
      });
    </script>
  </head>

  <body>
    <h1 id="qunit-header"></h1>
    <h2 id="qunit-banner"></h2>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
  </body>
</html>
